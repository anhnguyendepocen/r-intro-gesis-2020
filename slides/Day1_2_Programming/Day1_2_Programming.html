<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to R for Data Analysis</title>
    <meta charset="utf-8" />
    <meta name="author" content="Johannes Breuer Stefan Jünger" />
    <meta name="date" content="2020-08-03" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="..\workshop.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to R for Data Analysis
## Programming in R
### Johannes Breuer<br />Stefan Jünger
### 2020-08-03

---

layout: true




```
## 
## &lt;div class="my-footer"&gt;
##   &lt;div style="float: left;"&gt;&lt;span&gt;`r gsub("&lt;br /&gt;", ", ", gsub("&lt;br /&gt;&lt;br /&gt;|&lt;a.+$", "", metadata$author))`&lt;/span&gt;&lt;/div&gt;
##   &lt;div style="float: right;"&gt;&lt;span&gt;`r metadata$location`, `r metadata$date`&lt;/span&gt;&lt;/div&gt;
##   &lt;div style="text-align: center;"&gt;&lt;span&gt;`r gsub(".+&lt;br /&gt;", " ", metadata$subtitle)`&lt;/span&gt;&lt;/div&gt;
## &lt;/div&gt;
```




&lt;style type="text/css"&gt;
# .remark-slide-content {
#   font-size: 28px;
#   padding: 20px 80px 20px 80px;
# }
# .remark-code, .remark-inline-code {
#   background: #f0f0f0;
# }
# .remark-code {
#   font-size: 24px;
# }
# .huge .remark-code { /*Change made here*/
#   font-size: 200% !important;
# }
.tinyish .remark-code { /*Change made here*/
  font-size: 70% !important;
}
&lt;/style&gt;

---

## Content of this programming session 
.pull-left[
**What you will learn**
- How to write loops
- How to write functions
- Casual comparison of Base R vs. Tidyverse programming
]

.pull-right[
**What you won't learn**
- Full-blown programming introduction
- Lengthy comparison to other languages
- Exhausting review of data types, methods, and classes
- Debugging
]

---

## What is programming?
So, the all-knowing Wikipedia says programming involves:
- analysis
- generating algorithms
- profiling algorithms accuracy and resource consumption
- **implementation of algorithms in a chosen programming language**

.footnote[https://en.wikipedia.org/wiki/Computer_programming]

---

## R is/as a programming language
Originally, R was created for statistical analysis
- R package designers are no computer scientists
- Because of that, R is known as not being as efficient as other languages
  - Judge by yourself
  - It also depends on the **programming**


Many ways to interact with the language is similar to mathematical notation
- Don't get scared of that, yet this is why we deal with vectors, matrices, and so forth.

---

## It boils down to...
.pull-left[
**Where your data are stored**
- Vectors
- Matrices
- Data frames / Tibbles
- Lists
]

.pull-right[
**How your data are stored**
- 'Numbers' (Integers &amp; Doubles)
- Character Strings
- Logical
- Factors
- ...
- There's more, e.g., expressions, but let's leave it that way
]

.footnote[https://www.stat.berkeley.edu/~nolan/stat133/Fall05/lectures/DataTypes4.pdf]

---

## Vectors
Vectors are built by enclosing your content with `c()` ("c" for "combine")


```r
numeric_vector   &lt;- c(1, 2, 3, 4)
character_vector &lt;- c("a", "b", "c", "d")

numeric_vector
```

```
## [1] 1 2 3 4
```

```r
character_vector
```

```
## [1] "a" "b" "c" "d"
```

---

## Matrices
Matrices are the basic rectangular data format in R.


```r
fancy_matrix &lt;- matrix(1:16, nrow = 4)

fancy_matrix
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    1    5    9   13
## [2,]    2    6   10   14
## [3,]    3    7   11   15
## [4,]    4    8   12   16
```

You cannot store multiple data types, such as strings or numeric types. Otherwise your data is getting coerced in a common type.
- In fact, this is something that happens already in vectors

---

## Matrices and subscripts (as in mathematical annotation)
Identify rows, columns or elements using subscripts. 


```r
fancy_matrix[,4] # 4th column of matrix
fancy_matrix[3,] # 3rd row of matrix
fancy_matrix[2:4,1:3] # rows 2,3,4 of columns 1,2,3 
```

---

## Data frames
While matrices are used, e.g.,--\*drumroll\*-- for matrix operations, data frames
resembles more what we know of data we usually use. We can build data.frames by 
hand as here:


```r
library(randomNames) # a name generator package

fancy_data &lt;-
  data.frame(
    who = randomNames(n = 10, which.names = "first"),
    age = sample(14:49, 10, replace = TRUE),
    was_milk_available = sample(c(TRUE, FALSE), 10, replace = TRUE)
  )
```

---


```r
fancy_data
```

```
##            who age was_milk_available
## 1      Natalie  48               TRUE
## 2      Frances  33               TRUE
## 3       Hannah  17               TRUE
## 4      Janelle  39              FALSE
## 5      Spencer  35               TRUE
## 6        Daisy  23              FALSE
## 7   Brooklyvon  36               TRUE
## 8        Aaron  16              FALSE
## 9  Abdul Azeez  28              FALSE
## 10      Davina  29              FALSE
```

---

## tibbles
data.frames tend to be pretty large, and printing them on your screen can get
difficult. As part of the Tidyverse, tibbles faciliate printing (and adding
more metadata to the columns of a data.frame). Instead of using `data.frame()`
for our data creation we could have been using `tibble`. It looks like that:


```r
library(tibble)
as_tibble(fancy_data)
```

```
## # A tibble: 10 x 3
##    who           age was_milk_available
##    &lt;chr&gt;       &lt;int&gt; &lt;lgl&gt;             
##  1 Natalie        48 TRUE              
##  2 Frances        33 TRUE              
##  3 Hannah         17 TRUE              
##  4 Janelle        39 FALSE             
##  5 Spencer        35 TRUE              
##  6 Daisy          23 FALSE             
##  7 Brooklyvon     36 TRUE              
##  8 Aaron          16 FALSE             
##  9 Abdul Azeez    28 FALSE             
## 10 Davina         29 FALSE
```

---

## Object orientation in R
R is an object orientated language
- That's more than just assigning, e.g., a number to an object and working on it like 


```r
object &lt;- 2
object + 3
```

```
## [1] 5
```

Object orientation also includes, e.g., emphasis on attributes of data. They 
have a structure and belong to a class:


```r
str(character_vector)
```

```
##  chr [1:4] "a" "b" "c" "d"
```

```r
class(character_vector)
```

```
## [1] "character"
```
  
But we'll leave it at that for now

---

## Functional Programming: In R, everything's a function (more or less)
So you might already be familiar with using functions in R. Functions are 
applied as shown here:


```r
fancy_function(data)
```

They can be nested, for example:


```r
log(sum(c(1, 2, 3)))
```

```
## [1] 1.791759
```

Later on, we will learn about pipes `%&gt;%` which help to navigate some issues 
with too many levels of nesting

---

# Defining your own function is straightforward
First, let's create a simple function which is pasting together some strings
and numbers.


```r
milk_bought &lt;- function (n_bottles) {
  
  # define our string
  our_string &lt;- 
    paste0("I have bought ",  n_bottles, " bottles of milk")
  
  # we need to print it
  print(our_string)
}
```

Now, we can simply apply it to some dataa s in any other R function


```r
milk_bought(n_bottles = 20)
```

```
## [1] "I have bought 20 bottles of milk"
```

---

## Loops
We can use loops to iterate through data, applying a function

- if else
- for
- while
- apply family
- tidyverse implementation: `purrr::`

---

# Let's start with a joke
There's this silly programmer joke:

.large[
&gt; A room mate asked his friend who is a programmer to go shopping: "hey, can you buy a bottle of milk? Oh and if they have eggs, buy 12". So the programmer went shopping. When he got back, he bought 12 bottles of milk and his room mate asked "why the heck did you bought 12 bottle of milk?!" The programmer responded: "they have eggs"
]

.footnote[https://www.reddit.com/r/Jokes/comments/5qyxar/a_programmer_goes_shopping/]

---

## Translating this joke into R


```r
eggs_available &lt;- TRUE

if (isTRUE(eggs_available)) {
  milk_bought(n_bottles = 12)
} else {
  milk_bought(n_bottles = 1)
}
```

```
## [1] "I have bought 12 bottles of milk"
```


```r
eggs_available &lt;- FALSE

if (isTRUE(eggs_available)) {
  milk_bought(n_bottles = 12)
} else {
  milk_bought(n_bottles = 1)
}
```

```
## [1] "I have bought 1 bottles of milk"
```

---

# Extending our function


```r
milk_bought_2 &lt;- function (n_bottles) {
  if (n_bottles &lt; 2) {
    our_string &lt;-
      paste0("I have bought ", n_bottles, " bottle of milk")
  } else {
    our_string &lt;-
      paste0("I have bought ", n_bottles, " bottles of milk")
  }
  
  print(our_string)
}
```

---

## Now, that's better, right?


```r
eggs_available &lt;- FALSE

if (isTRUE(eggs_available)) {
  milk_bought_2(n_bottles = 12)
} else {
  milk_bought_2(n_bottles = 1)
}
```

```
## [1] "I have bought 1 bottle of milk"
```

---

## ifelse() shortcut


```r
ifelse(
  isTRUE(eggs_available),         # condition
  milk_bought_2(n_bottles = 12),  # if condition is true
  milk_bought_2(n_bottles = 1)    # else if condition is false
)
```

```
## [1] "I have bought 1 bottle of milk"
```

```
## [1] "I have bought 1 bottle of milk"
```


---

## And now blend it all together: function in a function

.tinyish[

```r
milk_bought_super &lt;- function (who, n_bottles, eggs_available) {

  if (who == "I") {
    buyer &lt;- "I have bought "
  } else {
    buyer &lt;- paste0(who, " has bought ")
  }
  
  milk_bought_2 &lt;- function (n_bottles) {
    if (n_bottles &lt; 2) {
      our_string &lt;-
        paste0(buyer, n_bottles, " bottle of milk")
    } else {
      our_string &lt;-
        paste0(buyer, n_bottles, " bottles of milk")
    }
    
    print(our_string)
  }
  
  if (isTRUE(eggs_available)) {
    milk_bought_2(n_bottles = 12)
  } else {
    milk_bought_2(n_bottles = 1)
  }
}
```
]

---

## The result


```r
milk_bought_super(who = "I", n_bottles = 12, eggs_available = TRUE)
```

```
## [1] "I have bought 12 bottles of milk"
```

```r
milk_bought_super(who = "Johannes", n_bottles = 12, eggs_available = FALSE)
```

```
## [1] "Johannes has bought 1 bottle of milk"
```

---

## for () loops
In my opinion, for loops are some of the most useful tools in functional programming.

They enable iterating through input data and applying functions to each element of the data
- it depends on specific purpose what defines this element
- thus, it is important to think about the iterator of the for call

---

## Architecture of for loops


```r
for (iterator_name in data) {
  do_some_stuff(iterator_name)
}
```

---

## Building some data


```r
library(randomNames)

our_data &lt;-
  data.frame(
    who = randomNames(n = 10, which.names = "first"),
    milk_available = sample(c("TRUE", "FALSE"), 10, replace = TRUE)
  )

our_data
```

```
##         who milk_available
## 1      Hugh          FALSE
## 2     Caleb           TRUE
## 3      Sara          FALSE
## 4      Anya          FALSE
## 5  Nooriyya           TRUE
## 6    Hannah          FALSE
## 7    Jaasir          FALSE
## 8      Hiba          FALSE
## 9   Adhraaa          FALSE
## 10     Carl           TRUE
```

---


```r
# for (1:nrow(our_data) in our_data) {
#   
# }
```


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
