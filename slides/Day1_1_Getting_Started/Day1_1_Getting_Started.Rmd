---
title: "Introduction to R for Data Analysis"
subtitle: "Getting Started with R and RStudio"
author: "Johannes Breuer<br />Stefan Jünger"
date: "2020-08-03"
location: "GESIS Summer School in Survey Methodology"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "default-fonts", "../workshop.css"]
    nature:
      highlightStyle: "github"
      highlightLines: true
      countIncrementalSlides: false
---
layout: true

```{r setup, include = F}
if (!require(easypackages)) install.packages("easypackages")
library(easypackages)

packages("rmarkdown", "knitr", "gadenbuie/xaringanExtra", "gadenbuie/tweetrmd", "huxtable", prompt = F)

options(htmltools.dir.version = FALSE)

opts_chunk$set(echo = FALSE, fig.align = "center")

xaringanExtra::use_tile_view()
```

<div class="my-footer">
  <div style="float: left;"><span>`r gsub("<br />", ", ", gsub("<br /><br />|<a.+$", "", metadata$author))`</span></div>
  <div style="float: right;"><span>`r metadata$location`, `r metadata$date`</span></div>
  <div style="text-align: center;"><span>`r gsub(".+<br />", " ", metadata$subtitle)`</span></div>
</div>

<style type="text/css">

pre {
  font-size: 10px
}
</style>

---

# About this course

In this course, we will provide an introduction to the basic concepts and functionalities of `R` and go through a prototypical data analysis workflow: import, wrangling, exploration, (basic) analysis, and reporting. 

By the end of this course you should...

- be comfortable with using *R* and *RStudio*
- be able to import, wrangle, and explore your data with *R*
- be able to conduct basic visualizations and analyses of your data with *R*

**Note**: This is not a statistics workshop. Our focus will be on learning how to use *R*.

---

# What we want to avoid

.center[<img src="./pics/owl.jpg" width="75%">]
<small><small>Source: https://bit.ly/2Xhz81a</small></small>

---

# Learning by coding

```{r hadley tweet}
tweet_embed("https://twitter.com/hadleywickham/status/589068687669243905",
            theme = "dark")
```

---

# Prerequisites for this course

.large[
- Working versions of `R` and *RStudio* on your computer 

- prior experience with data analysis, basic statistics, and regression 

- ideally, experience with using other statistical packages (e.g., *SPSS* or *Stata*)
]  

---

# About us

### Johannes Breuer

- senior researcher in the team Data Linking & Data Security at the GESIS Data Archive
    - main areas: data linking & digital trace data  
    
- Ph.D. in psychology, University of Cologne  

- previously worked in several research projects investigating the use and effects of digital media (Cologne, Hohenheim, Münster, Tübingen)  

- other research interests:
    - methods of media (effects) research
    - computational methods
    - data management
    - open science

[johannes.breuer@gesis.org](mailto:johannes.breuer@gesis.org), [@MattEagle09](https://twitter.com/MattEagle09), [personal website](https://www.johannesbreuer.com/)

---

# About us

### Stefan Jünger

- postdoctoal researcher in the team Data Linking & Data Security at the GESIS Data Archive
    - main area: geospatial data/georeferencing  
    
- Ph.D. in social sciences, University of Cologne

- previously worked in the area of data ingest and as a curator of the data repository *datorium* and two DFG research projects on geospatial data

- other research interests:
    - quantitative methods
    - social inequalities & attitudes towards minorities
    - data management & data privacy

[stefan.juenger@gesis.org](mailto:stefan.juenger@gesis.org),
[@StefanJuenger](https://twitter.com/StefanJuenger)

---

# Our jou`R`neys

Johannes

- was socialized with *SPSS*
- was annoyed with *AMOS* when learning structural equation modeling (around 2010)
- decided to learn to use the [`lavaan`](https://lavaan.ugent.be/) package for `R` instead of *MPlus* to avoid being dependent on yet another proprietary software package
- attended an *Introduction to `R` course* at *GESIS* in 2010
- only used `R` for SEM for some time, while still doing everything else (esp. data wrangling) with *SPSS*
- finally made the full transition to `R` when joining *GESIS* in 2017

Stefan

- a
- b
- c

---

# About you

.large[
- What's your name?  

- Where do you work/study? What are you working on/studying?

- What is your experience with `R` or other programming languages?

- What statistical software package(s) do typically use?

- What do you want to use `R` for?
]

---

# Preliminaries

.large[
- Feel free to ask questions at any time  

- We want to make this workshop as interactive as possible

- The workshop consists of a combination of lectures and hands-on exercises

- Slides and other materials are available at
]
.center[`https://github.com/jobreu/r-intro-gesis-2020`]

---

# Course schedule

```{r full schedule}
schedule <- data.frame(
  " " = c("10:00 - 12:30", "12:30 - 14:00", "14:00 - 16:30"),
  "Monday" = c("Getting started with R and RStudio", "<i>Lunch break</i>", "Programming with R"),
  "Tuesday" = c("Data import & export", "<i>Lunch break</i>", "Data wrangling: Base R vs. the Tidyverse"),
  "Wednesday" = c("Data visualization Part 1", "<i>Lunch break</i>", "Data visualization Part 2"),
  "Thursday" = c("Exploratory data analysis", "<i>Lunch break</i>", "Confirmatory data analysis"),
  "Friday" = c("Reporting with RMarkdown", "<i>Lunch break</i>", "Application example <i>Geospatial data analysis with R</i> or Extended Q&A session "),
  check.names = FALSE
)

ht <- as_hux(schedule)
bold(ht)[1,] <- TRUE
align(ht)[3,] <- "center"
align(ht)[,1] <- "center"
valign(ht)[3,] <-  "middle"
ht <- set_all_borders(ht, 1) 
ht <- merge_across(ht, 3, 2:6)
ht
```

---

# What is `R`?

>R is a free software environment for statistical computing and graphics. It compiles and runs on a wide variety of UNIX platforms, Windows and MacOS ([`R` Project website](https://www.r-project.org/)).

`R` is [free and open-source software (FOSS)](https://en.wikipedia.org/wiki/Free_and_open-source_software) and also a programming language. More specifically, it is a free, non-commercial implementation of the [`S` programming language](https://en.wikipedia.org/wiki/S_(programming_language) (developed by Bell Laboratories).

---

# A very brief history of `R`

- `R` was created by Ross Ihaka and Robert Gentleman at the Department of Statistics at the University of Auckland (NZ) in 1991

- The `R` *Core Group* that has been responsible for the development of `R` since then was created in 1997

- version `1.0.0` of `R` was released in 2000

- today we are at version `4.0.2`

If you want to know a bit more about the origins and history of `R` as well as the philosophy behind it, the book [*R Programming for Data Science*](https://bookdown.org/rdpeng/rprogdatascience/) by Roger D.Peng provides a [good summary](https://bookdown.org/rdpeng/rprogdatascience/history-and-overview-of-r.html).

---

# Why use `R`?

- it is **free** an **open-source**

--

- it is **modular** through the use of packages
  - You want to do X with `R`? There's ~~an app~~ a package for that!
  - The universe of packages for `R` keeps on expanding
  
--
  
- it can be used for almost all steps in the research process: data collection, processing, exploration, analysis, and reporting/publishing

--

- it offers extremely powerful and versatile options for **data visualization**

--

- it has a **great community** with groups like [*R-Ladies*](https://rladies.org/), the [*R Consortium*](https://www.r-consortium.org/), or [*rOpenSci*](https://ropensci.org/)
  - also check out the [*#rstats* hashtag on Twitter](https://twitter.com/search?q=%23rstats&src=typed_query)
  
--

- it is becoming **increasingly popular** in [academic publications](http://r4stats.com/articles/popularity/), [programming communities like Stack Overflow](https://stackoverflow.blog/2017/10/10/impressive-growth-r/), and also in [job advertisements](http://r4stats.com/articles/popularity/)

--

- it is **FUN**!

---

# Fun with `R`

You can use `R` to...

- read [Chuck norris jokes](https://cran.r-project.org/web/packages/norris/index.html)

--

- [create memes](https://github.com/sctyner/memer)
  - there's also a whole [genre of `R` memes](https://github.com/favstats/rstatsmemes)

--

- [create 3D LEGO mosaics from images](http://www.ryantimpe.com/post/lego-mosaic3/)
  - ... and even find out [which LEGO bricks you need to build them for real](https://github.com/ryantimpe/brickr)

--

- [play](https://github.com/gsimchoni/CastleOfR) or [create text adventures](https://lucidmanager.org/text-adventure/)

--

- [create objects in *Minecraft*](https://ropenscilabs.github.io/miner_book/)

--

- make all sorts of [dice rolls for your pen & paper/tabletop role-playing games](https://github.com/Felixmil/rollR)

---

# (My take on) `R` vs. `Python`

- both are great

- `Python` is more powerful for data collection and offer more (advanced) options for machine learning

- `R` is more powerful for data visualization and statistics

- both languages influence and sometimes directly build on each other
  - some popular `Python` libraries like `pandas` or `seaborn` have been inspired by `R` (packages)
  - some `R` packages are essentially wrappers for `Python` libraries (e.g., [`spacyr`](https://spacyr.quanteda.io/))

- you can use both together, e.g., via the [`reticulate` package for `R`](https://rstudio.github.io/reticulate/)
  - however, I would not recommend learning them in parallel (to avoid language confusion)
  
- there's a [blog post by Dominique Markowski](https://dominiquemakowski.github.io/post/r_or_python/) that provides some good guidance on choosing between `R` and `Python`

---

# (My take on) `R` vs. `Python`
  
- in terms of setting up and maintaining your installation, `R` is quite a bit easier to handle

```{r python tweet}
tweet_embed("https://twitter.com/johncassil/status/1281277159642972160",
            theme = "dark")
```

---

# Installing `R`

You can download `R` via the [`R` Project website](https://www.r-project.org/). The exact installation process depends on your operating system (OS). The *R Cookbook* provides a [detailed explanation of the installation process for *Windows*, *macOS*, and *Linux/Unix*](https://rc2e.com/gettingstarted#recipe-id001).

If you want or need to update your version of `R`, you can do this the same way as for the first-time installation. If you use *Windows*, you can also use the [`installr` package](https://github.com/talgalili/installr) to update `R` (we will talk about packages in a bit).

---

# Graphical user interfaces (GUI) for `R`

`R` comes with a basic GUI (on *Windows* you can access it by opening the `Rgui.exe` file). However, it is quite limited in terms of its functions.

```{r, basic R GUI, out.width = "95%"}
include_graphics("./pics/base_R_gui.png")
```

---

# Graphical user interfaces (GUI) for `R`

A more comprehensive GUI for `R` is [*R Commander*](https://cran.r-project.org/web/packages/Rcmdr/index.html) which essentially is a package for `R` that can be used via the basic GUI that comes with `R` or the `R` command line tool (`R.exe` on *Windows*).

```{r, R commander, out.width = "45%"}
include_graphics("./pics/r_commander.png")
```

---

# Intergrated development interfaces (IDE) for `R`

Using an IDE provides several advantages:
  - syntax highlighting
  - auto-completion
  - better overview of files, libraries, created objects/output

`R` can be used, e.g., with
  - [`gedit`](http://rgedit.sourceforge.net/)
  - `Emacs` via [ESS (Emacs Speaks Statistics)](https://ess.r-project.org/)
  - [`vim`](https://www.vim.org/scripts/script.php?script_id=2628)

The most easy-to-use IDE that is specifically tailored to `R` is [*RStudio*](https://rstudio.com/products/rstudio/) which is also what we will use for this workshop.

---

# Installing *RStudio*

You can download the installer for your OS from the [*RStudio* website](https://rstudio.com/products/rstudio/download/). The [*R Cookbook*](https://rc2e.com/) also provides some more [details on how to install and start *RStudio*](https://rc2e.com/gettingstarted#recipe-id002b).

When you open *RStudio* for the first time it should look like this (only in white instead of black and maybe not with `R` startup messages in German):

```{r, rstudio_1st, out.width = "80%"}
include_graphics("./pics/r_studio_noscript.png")
```

---

# *RStudio* interface

```{r, rstudio_1st_explained, out.width = "120%"}
include_graphics("./pics/rstudio_1st_explained.png")
```

---

# The `R` console in *RStudio*

The console is the interactive input-output window of *RStudio*. You can enter commands here and press <kbd>Enter</kbd> to execute them. Typically, the output the the commands you enter into the console will also be displayed here.

If you see the **`>`** in the console, it means that it is ready to receive commands.

If you see a **`+`** at the beginning of the console input line, this means that the command is incomplete. A common reason for this is a missing `)` or `"`. If you see the `+` at the beginning of the console input line, you can either complete the command (and then run it by pressing <kbd>Enter</kbd>/<kbd>Return</kbd>) or abort entering the command by pressing <kbd>Esc</kbd>.

Once you have executed at least one command in the console you can cycle through previous using ↑ and ↓ on your keyboard.

---

# `R` as a calculator

The simplest thing you can do with the `R` console is to use it as a calculator. 

```{r calc example 1, echo=T}
3+2
2^3
1/3
```

*Note:* In the console, you won't see the `##` in the output.
The `[1]` before the result indicates that this is the first output value of the command (more complex commands can have more than one output value).

---

# `R` as a calculator

The simplest thing you can do with the `R` console is to use it as a calculator. 

```{r calc example 2, echo=T}
100^3
1/2500
```

For printing very small and very large numbers, `R` uses [scientific notation](https://en.wikipedia.org/wiki/Scientific_notation). If you want to avoid this, you can use the command `options(scipen=999)`. **NB**: This setting will only be active for the current session.

```{r calc example scipen, echo=T}
options(scipen=999)
100^3
1/2500
```

---

# Objects in `R`

`R` is an object-oriented programming language.
The simplest example of assignment in `R` is the assignment of a single value to an object. This value can, e.g., be an single number or a character string. 

```{r assignment, echo = T}
x <- 10
y <- "This is a character string"

x
y
```

What is important to know and keep in mind is that all of your workspace (including all objects you loaded or created) in `R` is stored in your computer's working memory (RAM). This can become problematic if you work with "big data". However, there are solutions for working with larger-than-RAM data in `R`.

---

# `R` objects in *RStudio*

Once one or more objects have been assigned values they also appear in the `Environment` tab in *RStudio*.

```{r, rstudio_objects, out.width = "100%"}
include_graphics("./pics/rstudio_environment_objects.png")
```

---

# Functions

Put simply, a function takes an input, does something with it, and produces some sort of output. Functions have arguments. In the simplest case, a function only requires an input (a value or object) as a single argument. 

```{r function one arg, echo = T}
sqrt(9)
x <- 9
sqrt(x)
```

The output of a function can, of course, also be assigned to an object.

```{r function one arg assign, echo = T}
x <- sqrt(9)
x
```

---

# Functions

Most functions in `R` have more than one argument.

```{r function more args, echo = T}
y <- "This is a character string"

# replace i's in the character string with X's
gsub(pattern = "i", replacement = "X", y)
```

---

# Functions

If you want to access the help file for a function, you can use the following command:

```{r help file, echo = T, eval = F}
?gsub
```

This will open a file in the `Help` tab in *RStudio*.

```{r, help_example, out.width = "60%"}
include_graphics("./pics/help_example.png")
```

---

# Functions

Arguments can have required and optional arguments. Required arguments need to be specified for a function to run, whereas optional arguments have defaults and, hence, do not have to be provided in a function call.
You can easily identify required and optional arguments in the `Usage` section of the help file for a function: If the argument is in the format `argument = value` it is optional. If only the argument name is provided `function(argument_1)`, this means that this argument is required. 

```{r, help_example2, out.width = "55%"}
include_graphics("./pics/help_example.png")
```

---

# Functions

Function arguments can be provided in the specified order or by referencing them by name (in which case the order can change). For example, the following two versions of the `gsub` function call are both valid.

```{r funtion arguments, echo = T}
y <- "This is a character string"

gsub("i", "X", y)

gsub(y, replacement = "X", pattern = "i")
```

Typing the argument names is more work but it increases the comprehensibility of your code for human readers.

---

# `R` packages

---

# Installing and loading packages in `R`

---

# Packages about packages

---

# Other sources for `R` packages

---

# Managing packages

---

# `R` scripts

While the console is useful for trying things out, you should not use it for your actual data analysis. For this you should use `R` scripts that allow you to store and document your code. `R` scripts are similar to syntax files for *SPSS* or do-files for *Stata*. `R` scripts have the file extension `.R`.

In *RStudio*, you can create a new script via the menu (`File` -> `New File` -> `R Script`), by clicking the small white sheet icon with the green `+` symbol and choosing `R Script`, or through the keyboard shortcut <kbd>Ctrl + Shift + N</kbd> (*Windows* & *Linux*)/<kbd>Cmd + Shift + N</kbd> (*Mac*). You can open an existing script by clicking on it in the files tab, by clicking the open folder icon, via `File` -> `Open File`, or using the keyboard shortcut <kbd>Ctrl + O</kbd> (*Windows* & *Linux*)/<kbd>Cmd + O</kbd> (*Mac*).

---

# *RStudio* interface: Scripts

When you open or create a script in *RStudio* this will be displayed in a fourth pane (which will have multiple tabs if you open/create more than one `R` script).

```{r, rstudio_scripts, out.width = "100%"}
include_graphics("./pics/r_studio_script.png")
```

---

# Working with `R` scripts

You can write your code in an `R` script just like you do in the console. 

If you want to execute a single line of code from your script in *RStudio*, you can do so by placing your cursor somewhere in that line and clicking the `Run` button in the menu or by using the keyboard shortcut <kbd>Ctrl + Return</kbd> (*Windows* & *Linux*)/<kbd>Cmd + Enter</kbd> (*Mac*). This also works if you select multiple lines. **NB**: The number of lines in your script may differ from the number of lines you see in the *RStudio* pane (depending on the size of the pane and the length of the lines). The numbers on the left side of the script pane show the actual line numbers.

You can also run all commands in your script by selecting `Run all` from the dropdown menu next to the `Run` button or via the keyboard shortcut <kbd>Ctrl + Alt + R</kbd> (*Windows* & *Linux*)/<kbd>Cmd + Alt + R</kbd> (*Mac*).   

You can save your script in *RStudio* via `File` -> `Save` or``Save As...`, by clicking the small blue floppy disk icon, or through the keyboard shortcut <kbd>Ctrl + S</kbd> (*Windows* & *Linux*)/<kbd>Cmd + S</kbd> (*Mac*).   

---

# Commenting `R` scripts

To properly document your code (for your future self as well as other people who may use your code) it is good practice to use comments. In `R` scripts, you can create a comment by starting a line with a `#`.

In *RStudio*, to comment or uncomment one or more lines in a script you can also select them and use the keyboard shortcut <kbd>Ctrl + Shift + C</kbd> (*Windows* & *Linux*)/<kbd>Cmd + Shift + C</kbd> (*Mac*).

A neat trick in *RStudio* is that if you end a comment preceding a block of code with `####` (or more `#`), you create a section in your script that can be collapsed and expanded in the *RStudio* script pane. This also creates a small interactive table of contents for the script at the bottom of the script pane.

---

# Commenting `R` scripts

```{r, rstudio_scripts_expanded, out.width = "100%"}
include_graphics("./pics/script_sections_expanded_highlighted.png")
```

---

# Commenting `R` scripts

```{r, rstudio_scripts_collapsed, out.width = "100%"}
include_graphics("./pics/script_sections_collapsed_highlighted.png")
```

---

# Keyboard shortcuts in *RStudio*

*RStudio* offers a wide range of useful [keyboard shortcuts](https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts). You can access a *Keyboard Shortcut Quick Reference* in *RStudio* via `Help`-> `Keyboard Shortcuts Help`. There even is a keyboard shortcut for accessing the keyboard shortcuts help (very meta): <kbd>Alt + Shift + K</kbd> (*Windows* & *Linux*)/<kbd>Option + Shift + K</kbd> (*Mac*).

One *RStudio* keyboard shortcut that is particularly helpful for writing `R` code is the one for the assignment operator: <kbd>Alt + -</kbd> (*Windows* & *Linux*)/<kbd>Option + -</kbd> (*Mac*). 

---

# *RStudio* pane layout

You can adjust the size of the different panes in *RStudio* and you can minimize or maximize panes.
You can also customize the pane layout for *RStudio* by selecting `Tools` -> `Global Options` -> `Pane Layout` via the *RStudio* menu.

```{r, rstudio_panes, out.width = "45%"}
include_graphics("./pics/rstudio_pane_layout.png")
```

However, (for this workshop) we would advise that you keep the standard settings here.

---

# *RStudio* appearance

Via `Tools` -> `Global Options` -> `Appearance` you can change the looks of *RStudio* by choosing a theme and font (+ font size).

```{r, rstudio_appearance, out.width = "50%"}
include_graphics("./pics/rstudio_appearance.png")
```

*RStudio* also offers many other [customization options](https://support.rstudio.com/hc/en-us/articles/200549016-Customizing-RStudio).

---

# Themes and fonts

Personally, I think dark themes are easier on the eyes. Also, themes can highlight specific code parts (in different colors). If you want more themes than the ones offered by default in *RStudio*, the package [`rsthemes`](https://github.com/gadenbuie/rsthemes) has a good selection.

I also like monospaced programming fonts with ligatures. I currently use [`JetBrains Mono`](https://www.jetbrains.com/lp/mono/) but am also fond of the [`Fira Code`](https://github.com/tonsky/FiraCode) font (pun intended).

---

# Other useful settings & customizations for `R` and `RStudio`

---

# `R` workspace

---

# Working directory

---

# `R` projects

---

# `.Renviron`

---

# `.Rprofile`

---

# How to find help?

---

# Resources: Introductory books

[R for Data Science](https://r4ds.had.co.nz/) by Hadley Wickham

[R Cookbook: Proven recipes for data analysis, statistics, and graphics](https://rc2e.com/) by JD Long & Paul Teetor

[Hands-On Programming with R](https://rstudio-education.github.io/hopr/) by Garrett Grolemund

[R Programming for Data Science](https://bookdown.org/rdpeng/rprogdatascience/) by Roger D. Peng

[Quantitative Social Science Data with R](https://uk.sagepub.com/en-gb/eur/quantitative-social-science-data-with-r/book257236) by Brian J. Fogarty

[Discovering Statistics Using R](https://uk.sagepub.com/en-gb/eur/discovering-statistics-using-r/book236067) by Andy Field, Jeremy Miles, & Zoe Field
---

# Resources: Online courses & tutorials

[Overview of resources *learnR4free* by Mine Dogucu](https://www.learnr4free.com/)

[Overview of resources by the *easystats* `R` package suite](https://easystats.github.io/blog/resources/)

[Collection of *YouTube* channels by Flavio Azevado](http://flavioazevedo.com/stats-and-r-blog/2016/9/13/learning-r-on-youtube)

[*swirl* - Learn `R` in `R`](https://swirlstats.com/)

Learning `R` (and statistics) with a cute story and beautiful illustrations: [Teacups, Giraffes, & Statistics by Hasse Wallum & Desirée de Leon](https://tinystats.github.io/teacups-giraffes-and-statistics/)

---

# Resources: Cheatsheets

*RStudio* offers a good collection of [cheatsheets for R](https://www.rstudio.com/resources/cheatsheets/).

The following ones are of particular interest for this workshop:

- [RStudio IDE Cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf)

- [Data Import Cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf)

- [Data Transformation Cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf)

- [Data Visualization Cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf)

- [RMarkdown Cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf)
